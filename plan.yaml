---
table:
   AuditorA: YAkJunLY0Pv3AjZHD++blx5PKOYydceseKmejkQqCGA=
   EventA: Y6kVMKeW16Q8oNCGqlfCr12w5jaIzaJeoC+vfZIvb24=
   BucketA: GMpLkzapjAZTy/ggQju8PE4UjvmZmD30ZwICPB706d0=
   BucketB: tYsxMWCUQxpgfz+uVZk/WBC+/clQQevcrckBohUK14U=
   Data001: somehash
    
actions:
  - on: "E.{{EventA}}.e.codeRed || (E.{{EventA}}.e.codeOrange && E.{{EventA}}.e.codeYellow)"
    name: action1
    timeWindow: 5
    resetAfter: 30
    do: 
     - function: "{{AuditorA}}.f.sign"
       params:
           actionOnSource: send
           actionOnDestination: receive
           sourceActor: "{{BucketA}}"
           destinationActor: "{{BucketB}}"
           dataset: "{{Data001}}"
       return:
           ref: tokenA
           200:
             - eventName: "{{me}}.e.signA"
               eventType: "String"
               eventValue: "{{tokenA}}"
             - eventName: "{{me}}.e.counter"
               eventType: "Number"
               eventValue: "10"
           400:
               eventName: "{{me}}.e.error"
               eventType: "Object"
               eventValue: "{{tokenA}}"
  - on: "E.{{me}}.e.counter > 0"
    resetAfter: 0
    name: counter1
    do: 
     - function: "{{BucketA}}.f.loop"
       params:
           counter: "{{{{me}}.e.counter.value}}"
       return:
           ref: counterA
           200:
             - eventName: "{{me}}.e.counter"
               eventType: "Number"
               eventValue: "{{counterA}}"
           400:
             eventName: "{{me}}.e.error"
  - on: "E.{{me}}.e.signA"
    resetAfter: 30
    name: copy1
    do: 
     - function: "{{BucketA}}.f.send"
       params:
           remoteCall: "{{BucketB}}.f.receive"
           dataset: "{{Data001}}"
           token: "{{{{me}}.e.signA.value}}"
       return:
           ref: resultCopy1
           200:
            - eventName: "{{me}}.e.copy1"
              eventType: "String"
              eventValue: "{{resultCopy1}}"
           400:
             eventName: "{{me}}.e.error"
  - on: "E.{{me}}.e.copy1"
    name: result1
    resetAfter: 30
    do:
     - function: "{{me}}.f.handleResult"
       params:
          result: "{{resultCopy1}}"
       result: 
          ref: "None"
          200: []
          400: []

   
